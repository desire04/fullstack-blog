{"ast":null,"code":"import{useState,useEffect}from'react';import{useParams}from\"react-router-dom\";import axios from'axios';import NotFoundPage from\"./NotFoundPage\";import CommentsList from'../components/CommentsList';import AddCommentForm from'../components/AddCommentForm';import useUser from'../hooks/useUser';import articles from\"./article-content\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ArticlePage=()=>{const[articleInfo,setArticleInfo]=useState({upvotes:0,comments:[],canUpvote:false});const{canUpvote}=articleInfo;const{articleId}=useParams();const{user,isLoading}=useUser();useEffect(()=>{const loadArticleInfo=async()=>{const token=user&&(await user.getIdToken());const headers=token?{authtoken:token}:{};const response=await axios.get(`/api/articles/${articleId}`,{headers});;const newArticleInfo=response.data;setArticleInfo(newArticleInfo);};if(isLoading){loadArticleInfo();}},[isLoading,user]);const article=articles.find(article=>article.name===articleId);const addUpvote=async()=>{const token=user&&(await user.getIdToken());const headers=token?{authtoken:token}:{};const response=await axios.put(`/api/articles/${articleId}/upvote`,null,{headers});const updatedArticle=response.data;setArticleInfo(updatedArticle);};if(!article){return/*#__PURE__*/_jsx(NotFoundPage,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{children:article.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"upvotes-section\",children:[user?/*#__PURE__*/_jsx(\"button\",{onClick:addUpvote,children:canUpvote?'Upvote':'Already Upvoted'}):/*#__PURE__*/_jsx(\"button\",{children:\"Log in to upvote\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"This article has \",articleInfo.upvotes,\" upvote(s)\"]})]}),article.content.map((paragraph,i)=>/*#__PURE__*/_jsx(\"p\",{children:paragraph},i)),user?/*#__PURE__*/_jsx(AddCommentForm,{articleName:articleId,onArticleUpdated:updatedArticle=>setArticleInfo(updatedArticle)}):/*#__PURE__*/_jsx(\"button\",{children:\"Log in to add a comment\"}),/*#__PURE__*/_jsx(CommentsList,{comments:articleInfo.comments})]});};export default ArticlePage;","map":{"version":3,"names":["useState","useEffect","useParams","axios","NotFoundPage","CommentsList","AddCommentForm","useUser","articles","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ArticlePage","articleInfo","setArticleInfo","upvotes","comments","canUpvote","articleId","user","isLoading","loadArticleInfo","token","getIdToken","headers","authtoken","response","get","newArticleInfo","data","article","find","name","addUpvote","put","updatedArticle","children","title","className","onClick","content","map","paragraph","i","articleName","onArticleUpdated"],"sources":["/Users/zahyoo/FullstackBlog/my-blog/src/pages/ArticlePage.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useParams } from \"react-router-dom\";\nimport axios from 'axios';\nimport NotFoundPage from \"./NotFoundPage\";\nimport CommentsList from '../components/CommentsList';\nimport AddCommentForm from '../components/AddCommentForm';\nimport useUser from '../hooks/useUser';\nimport articles from \"./article-content\";\n\n\n\nconst ArticlePage = () => {\n    const [articleInfo, setArticleInfo] = useState({ upvotes: 0, comments: [], canUpvote: false });\n    const { canUpvote } = articleInfo;\n    const { articleId } = useParams();\n\n    const { user, isLoading } = useUser();\n\n    useEffect(() => {\n        const loadArticleInfo = async() => {\n            const token = user && await user.getIdToken();\n            const headers = token ? { authtoken : token } : {};\n            const response = await axios.get(`/api/articles/${articleId}`, { headers });;\n            const newArticleInfo = response.data;\n            setArticleInfo(newArticleInfo);\n    }   \n    \n    if (isLoading) {\n        loadArticleInfo();\n    }\n        \n    }, [isLoading, user]);\n\n   \n    const article = articles.find(article => article.name === articleId);\n\n    const addUpvote = async () => {\n        const token = user && await user.getIdToken();\n        const headers = token ? { authtoken : token } : {};\n        const response = await axios.put(`/api/articles/${articleId}/upvote`, null, { headers });\n        const updatedArticle = response.data;\n        setArticleInfo(updatedArticle);\n    }\n\n    if(!article) {\n        return <NotFoundPage />\n    }\n    \n    return (\n        <>\n        <h1>{article.title}</h1> \n        <div className=\"upvotes-section\">\n            {user \n                ?<button onClick={addUpvote}>{canUpvote ? 'Upvote' : 'Already Upvoted'}</button>\n                : <button>Log in to upvote</button>\n            }\n            <p>This article has {articleInfo.upvotes} upvote(s)</p>\n        </div>\n        {article.content.map((paragraph, i) => (\n            <p key={i}>{paragraph}</p>\n        ))}\n        {user \n        ? <AddCommentForm\n                articleName={articleId}\n                onArticleUpdated={updatedArticle => setArticleInfo(updatedArticle)} />\n        : <button>Log in to add a comment</button>}\n        <CommentsList comments={articleInfo.comments} />\n        </>\n    );\n}\n\nexport default ArticlePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}